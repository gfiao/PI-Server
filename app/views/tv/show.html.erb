<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <%= stylesheet_link_tag 'tv.css' %>
  <%= stylesheet_link_tag 'mediaelementplayer.css' %>
  <%= javascript_include_tag 'trabalho.js' %>
  <%= javascript_include_tag 'jquery-2.1.1.min.js', 'application' %>
  <%= javascript_include_tag 'mediaelement-and-player.min.js', 'application' %>
</head>
<body onload="init()">

<div class="" id="main">

  <div class="" id="video-and-lateral">

    <div class="" id="logotype">
      <h2>CampusTV</h2>
    </div>

    <div class="" id="view-area">

      <!--<video width="640" height="360" id="player1" autoplay>-->
        <!--<source type="video/youtube" src="http://www.youtube.com/watch?v=nOEw9iiopwI" />-->
      <!--</video>-->
      <!--https://www.youtube.com/watch?v=iaItmiZTHP8-->

      <!--<%= Video.second.link %>?autoplay=1&controls=0&showinfo=0&rel=0
      https://www.youtube.com/embed/M7lc1UVf-VE?autoplay=1&controls=0&showinfo=0&rel=0&modestbranding=1 -->

<!--
      <%= Video.all.each do |video| %>
      <iframe width="100%" height="100%" src="<%= video.link %>?autoplay=1&controls=0&showinfo=0&rel=0&modestbranding=1&enablejsapi=1&playerapiid=ytplayer"
              frameborder="0"></iframe>
       <% end %>
-->
          <iframe width="100%" height="100%" src="<%= Video.first.link %>?autoplay=1&controls=0&showinfo=0&rel=0"
                  frameborder="0"></iframe>

      <!--<#%= video_tag 'https://www.youtube.com/watch?v=vBZ5SLJmfdw', size: '600x400', type: "video/youtube", controls: true, autoplay: true %>-->
    </div>

        //        function getValues() {
        //            var result = [];
        //            $.get("/videos", function (data) {
        //                $.each(data, function (i, value) {
        //                    result[i] = value.link;
        //                })
        //            }, "json");
        //            return result;
        //        }

        jQuery.extend({
                    getValues: function (url) {
                        var result = null;
                        $.ajax({
                            url: url,
                            type: 'get',
                            dataType: 'json',
                            async: false,
                            cache: false,
                            success: function (data) {
                                result = data;
                            }
                        });
                        return result;
                    }
                }
        );

        videos = $.getValues('/videos');
        console.log(videos);

        //  2. This code loads the IFrame Player API code asynchronously.
        var tag = document.createElement('script');

        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        // 3. This function creates an <iframe> (and YouTube player)
        //    after the API code downloads.
        var player;
        var counterVid = 0;
        function onYouTubeIframeAPIReady() {
            player = new YT.Player('view-area', {
                height: '390',
                width: '640',
                videoId: videos[counterVid].link.split('/')[4], //retorna codigo dos videos
                playerVars: { 'autoplay': 1, 'controls': 0 , 'showinfo': 0, 'rel': 0, 'modestbranding': 1},
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
        }

        // 4. The API will call this function when the video player is ready.
        function onPlayerReady(event) {
            event.target.playVideo();
        }

        // 5. The API calls this function when the player's state changes.
        //    The function indicates that when playing a video (state=1),
        //    the player should play for six seconds and then stop.
        var done = false;
        function onPlayerStateChange(event) {
            if (event.data == YT.PlayerState.PLAYING && !done) {
                setTimeout(incCounter, 6000);
                done = true;
            }
        }

        function incCounter() {
            if (counterVid < videos.length)
                counterVid++;
            else counterVid = 0;

            onYouTubeIframeAPIReady();
        }
    </script>


    <div class="" id="right-panel">

      <div class="" id="right-panel-top">
        <div id="hour-date">
          <div id="hour-info">
            <h1>12:40</h1>
          </div>
          <div id="date-info">
            <h3>Sexta, 20</h3>

            <h3>Outubro</h3>
          </div>

        </div>
      </div>
      <div class="" id="right-panel-middle">

        
      </div>

      <div class="" id="right-panel-bottom">
        <div id="meteo-info">
          <div id="meteo-min-temp">
            <div id="max-temp-img">

            </div>
            <div id="max-temp-value">

            </div>
          </div>
          <div id="meteo-max-temp">
            <div id="min-temp-img">

            </div>
            <div id="min-temp-value">

            </div>
          </div>
        </div>
      </div>


    </div>

  </div>

  <div class="" id="footer">

    <div class="" id="category">
      <p><b>ÚLTIMA HORA</b></p>
    </div>

    <div class="" id="news-container">
      <p>Uma pequena noticia, só para arrancar com a cena hehehehehehehehehehehehehe</p>
    </div>

  </div>

</div>

</body>
</html>